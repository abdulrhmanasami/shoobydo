# /etc/nginx/conf.d/shoobydo.conf
limit_req_zone $binary_remote_addr zone=auth:10m rate=60r/m;

server {
  listen 443 ssl http2;
  server_name api.your-domain.tld;
  ssl_certificate     /etc/letsencrypt/live/your-domain/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/your-domain/privkey.pem;

  add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
  add_header X-Frame-Options DENY;
  add_header X-Content-Type-Options nosniff;
  add_header Referrer-Policy no-referrer;

  location /api/v1/login   { limit_req zone=auth burst=20 nodelay; proxy_pass http://127.0.0.1:8080; }
  location /api/v1/refresh { limit_req zone=auth burst=20 nodelay; proxy_pass http://127.0.0.1:8080; }
  location / { proxy_pass http://127.0.0.1:8080; }
}
